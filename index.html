<! DOCTYPE html>
<html>
	<head>
		<script type="module">
			import {React, ReactDOM} from 'https://unpkg.com/es-react@16.13.1'
			import htm from 'https://unpkg.com/htm?module'
			import { endpoint } from 'https://cdn.skypack.dev/@octokit/endpoint'
			const html = htm.bind(React.createElement)
			const TOKEN = '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'
			const seedlings = (props) => {
				const [issues, setIssues] = React.useState([])
				React.useEffect(() => {
					async function fetchIssues() {
						const {url, ...options} = endpoint('GET /repos/:owner/:repo/issues', {
							owner: 'carolisengineering',
							repo: 'the-conservatory',
							auth: TOKEN
						})
						const response = await fetch(url, options)
						const issues = await response.json()
						setIssues(issues)
					}
					fetchIssues()
				}, [])
				return html`
					${issues.map(({number, title, body}) => {
						return html`
							<div id=${number, title, body} key=${number}>
								<h1>${title}</h1>
								<div>${body}</div>
							</div>
							`
					})} 	
				`
			}	
			ReactDOM.render(html` <${seedlings} /> `, document.body)
		</script>
	</head>
	<body></body>
</html>